<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="BalentineV2.UI.Components.Navigation.IconRailView"
    x:Name="Root"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
    BackgroundColor="Transparent"
    HorizontalOptions="Start"
    VerticalOptions="Fill">

    <!-- SADECE RAIL (toggle yok) -->
    <!-- Yapı aynı: Grid + Header + CollectionView -->
    <Grid
        RowDefinitions="92,*"
        WidthRequest="{Binding Source={x:Reference Root}, Path=RailWidth}"
        HorizontalOptions="Start"
        VerticalOptions="Fill">

        <!-- ✅ ARKAPLAN MAKYAJI (PDF benzeri) -->
        <!-- 1) Outer border -->
        <!-- ✅ PDF tadında gradient arka plan -->
        <Border Grid.RowSpan="2"
        Stroke="#2C3238"
        StrokeThickness="1"
        StrokeShape="RoundRectangle 0"
        HorizontalOptions="Fill"
        VerticalOptions="Fill">

            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">

                    <!-- Üst (çok hafif açık, logo arkası) -->
                    <GradientStop Color="#2E3A45" Offset="0.00" />

                    <!-- Üst-Orta -->
                    <GradientStop Color="#29343E" Offset="0.30" />

                    <!-- Orta (ana ton) -->
                    <GradientStop Color="#232D36" Offset="0.60" />

                    <!-- Alt (daha koyu) -->
                    <GradientStop Color="#1C242B" Offset="1.00" />

                </LinearGradientBrush>
            </Border.Background>
        </Border>

        <!-- ✅ Soldan sağa hafif aydınlanma (ters sheen) -->
        <BoxView Grid.RowSpan="2" Opacity="0.10" InputTransparent="True">
            <BoxView.Background>
                <LinearGradientBrush StartPoint="1,0" EndPoint="0,0">
                    <!-- sağdan açık -->
                    <GradientStop Color="#FFFFFF" Offset="0.00" />
                    <GradientStop Color="#FFFFFF" Offset="0.12" />
                    <!-- sola doğru koyulaş -->
                    <GradientStop Color="#000000" Offset="0.40" />
                    <GradientStop Color="#000000" Offset="1.00" />
                </LinearGradientBrush>
            </BoxView.Background>
        </BoxView>

        <!-- ✅ Sağ iç kenar gölgesi (derinlik) -->
        <BoxView Grid.RowSpan="2"
         HorizontalOptions="End"
         WidthRequest="2"
         BackgroundColor="#000000"
         Opacity="0.18"
         InputTransparent="True" />


        <!-- HEADER -->
        <Grid Grid.Row="0" Padding="12,12,12,12">

            <!-- Expanded logo -->
            <Image Source="yatay_logo.png"
                   HeightRequest="34"
                   HorizontalOptions="Start"
                   VerticalOptions="Center"
                   Aspect="AspectFit"
                   IsVisible="{Binding Source={x:Reference Root}, Path=IsExpanded}">
                <Image.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnLogoTapped" />
                </Image.GestureRecognizers>
            </Image>

            <!-- Collapsed logo -->
            <Image Source="celikel_logo.png"
                   HeightRequest="46"
                   WidthRequest="46"
                   HorizontalOptions="Center"
                   VerticalOptions="Center"
                   Aspect="AspectFit"
                   IsVisible="{Binding Source={x:Reference Root}, Path=IsCollapsed}">
                <Image.GestureRecognizers>
                    <TapGestureRecognizer Tapped="OnLogoTapped" />
                </Image.GestureRecognizers>
            </Image>

            <!-- Header divider -->
            <BoxView HeightRequest="1"
                     BackgroundColor="#3A3F46"
                     VerticalOptions="End"
                     Opacity="0.7"
                     Margin="0,0,0,2"
                     IsVisible="{Binding Source={x:Reference Root}, Path=IsExpanded}" />
        </Grid>

        <!-- MENU -->
        <CollectionView x:Name="MenuList"
                        Grid.Row="1"
                        ItemsSource="{Binding Source={x:Reference Root}, Path=MenuItems}"
                        SelectionMode="Single"
                        SelectionChanged="OnMenuSelectionChanged"
                        BackgroundColor="Transparent"
                        HorizontalOptions="Fill"
                        VerticalOptions="Fill">

            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="10,10"
                          ColumnDefinitions="44,*,18"
                          HeightRequest="52"
                          HorizontalOptions="Fill">

                        <!-- Basit arka plan (şimdilik highlight burada değil) -->
                        <Border Grid.ColumnSpan="3"
                                StrokeThickness="0"
                                BackgroundColor="Transparent"
                                StrokeShape="RoundRectangle 10" />

                        <!-- Icon (✅ sabit tint: siyaha dönmez) -->
                        <Image Grid.Column="0"
                               Source="{Binding IconSvg}"
                               WidthRequest="26"
                               HeightRequest="26"
                               HorizontalOptions="Center"
                               VerticalOptions="Center">
                            <Image.Behaviors>
                                <toolkit:IconTintColorBehavior TintColor="#C9CED6" />
                            </Image.Behaviors>
                        </Image>

                        <!-- Title (expanded only) -->
                        <Label Grid.Column="1"
                               Text="{Binding Title}"
                               FontSize="16"
                               FontAttributes="Bold"
                               VerticalOptions="Center"
                               LineBreakMode="TailTruncation"
                               MaxLines="1"
                               TextColor="#D8DEE6"
                               IsVisible="{Binding Source={x:Reference Root}, Path=IsExpanded}" />

                        <!-- Chevron (expanded only) -->
                        <Label Grid.Column="2"
                               Text="›"
                               FontSize="18"
                               VerticalOptions="Center"
                               HorizontalTextAlignment="End"
                               TextColor="#AAB0B7"
                               IsVisible="{Binding Source={x:Reference Root}, Path=IsExpanded}" />
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

    </Grid>
</ContentView>
